{
  "version": 3,
  "sources": ["../src/content/bridge.ts"],
  "sourcesContent": ["/// <reference types=\"chrome\" />\n\n// This content script acts as a bridge between the Web App (page context)\n// and the Extension Background Script (extension context).\n// It relays messages because normal web pages cannot directly talk to \n// background scripts unless declared in \"externally_connectable\".\n\nconst allowedOrigins = new Set([\n  'http://localhost:5173', // Default Vite dev port\n  'http://127.0.0.1:5173',\n  'https://vessel.api'     // Production definition\n]);\n\nglobalThis.addEventListener('message', async (event) => {\n  // Security check: only allow messages from trusted origins\n  // For loopback/dev, we allow basic origin checks\n  if (event.source !== globalThis.window) return;\n  \n  // Strict origin check for production-like behavior\n  if (!allowedOrigins.has(event.origin) && event.origin !== 'null') {\n    // Note: 'null' origin might happen on local files, be careful in prod\n    return;\n  }\n\n  const { data } = event;\n\n  // Handle PING (Availability Check)\n  if (data?.type === 'VESSEL_API_PING') {\n    // Respond immediately to say \"I'm here\"\n    globalThis.window.postMessage({\n      type: 'VESSEL_API_PONG',\n      checkId: data.checkId,\n    }, event.origin);\n    return;\n  }\n\n  // Handle REQUEST\n  if (data?.type === 'VESSEL_API_REQUEST') {\n    try {\n      // Forward to background script\n      const response = await chrome.runtime.sendMessage(data);\n      \n      // Send response back to page\n      globalThis.window.postMessage({\n        type: 'VESSEL_API_RESPONSE',\n        requestId: data.requestId,\n        ...response\n      }, event.origin);\n    } catch (err) {\n      globalThis.window.postMessage({\n        type: 'VESSEL_API_RESPONSE',\n        requestId: data.requestId,\n        success: false,\n        error: String(err)\n      }, event.origin);\n    }\n  }\n});\n"],
  "mappings": ";;;AAOA,MAAM,iBAAiB,oBAAI,IAAI;AAAA,IAC7B;AAAA;AAAA,IACA;AAAA,IACA;AAAA;AAAA,EACF,CAAC;AAED,aAAW,iBAAiB,WAAW,OAAO,UAAU;AAGtD,QAAI,MAAM,WAAW,WAAW,OAAQ;AAGxC,QAAI,CAAC,eAAe,IAAI,MAAM,MAAM,KAAK,MAAM,WAAW,QAAQ;AAEhE;AAAA,IACF;AAEA,UAAM,EAAE,KAAK,IAAI;AAGjB,QAAI,MAAM,SAAS,mBAAmB;AAEpC,iBAAW,OAAO,YAAY;AAAA,QAC5B,MAAM;AAAA,QACN,SAAS,KAAK;AAAA,MAChB,GAAG,MAAM,MAAM;AACf;AAAA,IACF;AAGA,QAAI,MAAM,SAAS,sBAAsB;AACvC,UAAI;AAEF,cAAM,WAAW,MAAM,OAAO,QAAQ,YAAY,IAAI;AAGtD,mBAAW,OAAO,YAAY;AAAA,UAC5B,MAAM;AAAA,UACN,WAAW,KAAK;AAAA,UAChB,GAAG;AAAA,QACL,GAAG,MAAM,MAAM;AAAA,MACjB,SAAS,KAAK;AACZ,mBAAW,OAAO,YAAY;AAAA,UAC5B,MAAM;AAAA,UACN,WAAW,KAAK;AAAA,UAChB,SAAS;AAAA,UACT,OAAO,OAAO,GAAG;AAAA,QACnB,GAAG,MAAM,MAAM;AAAA,MACjB;AAAA,IACF;AAAA,EACF,CAAC;",
  "names": []
}
