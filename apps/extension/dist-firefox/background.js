"use strict";(()=>{chrome.runtime.onMessage.addListener((e,s,t)=>{if(e.type==="VESSEL_API_REQUEST")return c(e.payload).then(t).catch(r=>t({success:!1,error:String(r)})),!0});chrome.runtime.onMessageExternal.addListener((e,s,t)=>{if(e.type==="VESSEL_API_PING")return t({type:"VESSEL_API_PONG",checkId:e.checkId}),!1;if(e.type==="VESSEL_API_REQUEST")return c(e.payload).then(t).catch(r=>t({success:!1,error:String(r)})),!0});async function c(e){let s=performance.now();try{let t=new AbortController,r=setTimeout(()=>t.abort(),e.timeout??3e4),n=await fetch(e.url,{method:e.method,headers:e.headers,body:e.body,signal:t.signal});clearTimeout(r);let i=performance.now()-s,a=await n.text(),u=performance.now()-s,o={};return n.headers.forEach((d,h)=>{o[h]=d}),{success:!0,response:{status:n.status,statusText:n.statusText,headers:o,body:a,timing:{firstByte:Math.round(i),total:Math.round(u)},size:{headers:JSON.stringify(o).length,body:a.length}}}}catch(t){return{success:!1,error:t instanceof Error?t.message:String(t)}}}})();
