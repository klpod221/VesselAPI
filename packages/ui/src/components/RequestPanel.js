import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useState } from 'react';
import { Plus, Trash2, Send } from 'lucide-react';
import { useRequestStore } from '@vessel/core';
import { CodeEditor } from './CodeEditor';
import { Button } from './Button';
import { cn, getMethodColor } from '../lib/utils';
export function RequestPanel() {
    const { activeRequest, updateRequest, executeRequest, isLoading } = useRequestStore();
    const [activeTab, setActiveTab] = useState('params');
    if (!activeRequest) {
        return (_jsx("div", { className: "flex h-full items-center justify-center text-muted-foreground p-4", children: "Select or create a request to get started" }));
    }
    const handleSend = () => {
        executeRequest();
    };
    const addKeyValuePair = (type) => {
        updateRequest({
            [type]: [...activeRequest[type], { id: crypto.randomUUID(), key: '', value: '', enabled: true }]
        });
    };
    const updateKeyValuePair = (type, index, updates) => {
        const newItems = [...activeRequest[type]];
        newItems[index] = { ...newItems[index], ...updates };
        updateRequest({ [type]: newItems });
    };
    const removeKeyValuePair = (type, index) => {
        const newItems = activeRequest[type].filter((_, i) => i !== index);
        updateRequest({ [type]: newItems });
    };
    return (_jsxs("div", { className: "flex h-full flex-col glass-panel rounded-lg overflow-hidden", children: [_jsxs("div", { className: "flex items-center gap-2 p-4 border-b border-glass-border", children: [_jsxs("div", { className: "relative", children: [_jsx("select", { value: activeRequest.method, onChange: (e) => updateRequest({ method: e.target.value }), className: cn("h-10 appearance-none rounded-md px-3 pr-8 text-sm font-bold shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input", getMethodColor(activeRequest.method)), children: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS'].map((m) => (_jsx("option", { value: m, className: "bg-popover text-popover-foreground", children: m }, m))) }), _jsx("div", { className: "pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground/50", children: _jsx("svg", { width: "10", height: "6", viewBox: "0 0 10 6", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: _jsx("path", { d: "M1 1L5 5L9 1", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round" }) }) })] }), _jsx("div", { className: "flex-1 relative", children: _jsx("input", { type: "text", value: activeRequest.url, onChange: (e) => updateRequest({ url: e.target.value }), placeholder: "https://api.example.com/v1/resource", className: "flex h-10 w-full rounded-md px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" }) }), _jsx(Button, { onClick: handleSend, disabled: isLoading || !activeRequest.url, className: "h-10 px-6 font-semibold shadow-lg shadow-primary/20", children: isLoading ? (_jsxs(_Fragment, { children: [_jsx("span", { className: "mr-2 h-4 w-4 animate-spin rounded-full border-2 border-background border-r-transparent" }), "Sending..."] })) : (_jsxs(_Fragment, { children: [_jsx(Send, { className: "mr-2 h-4 w-4" }), "Send"] })) })] }), _jsx("div", { className: "flex border-b border-glass-border px-4 bg-glass-highlight/30", children: ['params', 'headers', 'auth', 'body'].map((tab) => (_jsxs("button", { onClick: () => setActiveTab(tab), className: cn("border-b-2 px-4 py-2 text-sm font-medium transition-colors hover:text-primary relative", activeTab === tab
                        ? "border-primary text-primary"
                        : "border-transparent text-muted-foreground"), children: [tab.charAt(0).toUpperCase() + tab.slice(1), activeTab === tab && (_jsx("span", { className: "absolute inset-0 bg-primary/5 rounded-t-md pointer-events-none" }))] }, tab))) }), _jsxs("div", { className: "flex-1 overflow-auto p-4 relative", children: [activeTab === 'params' && (_jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("h3", { className: "text-sm font-medium text-muted-foreground", children: "Query Parameters" }), _jsxs(Button, { variant: "ghost", size: "sm", onClick: () => addKeyValuePair('queryParams'), className: "glass-button h-8", children: [_jsx(Plus, { className: "h-4 w-4 mr-1" }), " Add Param"] })] }), activeRequest.queryParams.map((param, index) => (_jsxs("div", { className: "flex gap-2 items-center group", children: [_jsx("input", { type: "checkbox", checked: param.enabled, onChange: (e) => updateKeyValuePair('queryParams', index, { enabled: e.target.checked }), className: "rounded border-glass-border bg-glass-highlight text-primary focus:ring-primary/20" }), _jsx("input", { placeholder: "Key", value: param.key, onChange: (e) => updateKeyValuePair('queryParams', index, { key: e.target.value }), className: "flex h-9 w-full rounded-md px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" }), _jsx("input", { placeholder: "Value", value: param.value, onChange: (e) => updateKeyValuePair('queryParams', index, { value: e.target.value }), className: "flex h-9 w-full rounded-md px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" }), _jsx(Button, { variant: "ghost", size: "icon", className: "h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive hover:bg-destructive/10", onClick: () => removeKeyValuePair('queryParams', index), children: _jsx(Trash2, { className: "h-4 w-4" }) })] }, param.id))), activeRequest.queryParams.length === 0 && (_jsx("div", { className: "text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-glass-border rounded-lg", children: "No query parameters used" }))] })), activeTab === 'headers' && (_jsxs("div", { className: "space-y-4", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("h3", { className: "text-sm font-medium text-muted-foreground", children: "HTTP Headers" }), _jsxs(Button, { variant: "ghost", size: "sm", onClick: () => addKeyValuePair('headers'), className: "glass-button h-8", children: [_jsx(Plus, { className: "h-4 w-4 mr-1" }), " Add Header"] })] }), activeRequest.headers.map((header, index) => (_jsxs("div", { className: "flex gap-2 items-center group", children: [_jsx("input", { type: "checkbox", checked: header.enabled, onChange: (e) => updateKeyValuePair('headers', index, { enabled: e.target.checked }), className: "rounded border-glass-border bg-glass-highlight text-primary focus:ring-primary/20" }), _jsx("input", { placeholder: "Key", value: header.key, onChange: (e) => updateKeyValuePair('headers', index, { key: e.target.value }), className: "flex h-9 w-full rounded-md px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" }), _jsx("input", { placeholder: "Value", value: header.value, onChange: (e) => updateKeyValuePair('headers', index, { value: e.target.value }), className: "flex h-9 w-full rounded-md px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" }), _jsx(Button, { variant: "ghost", size: "icon", className: "h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive hover:bg-destructive/10", onClick: () => removeKeyValuePair('headers', index), children: _jsx(Trash2, { className: "h-4 w-4" }) })] }, header.id))), activeRequest.headers.length === 0 && (_jsx("div", { className: "text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-glass-border rounded-lg", children: "No custom headers" }))] })), activeTab === 'auth' && (_jsxs("div", { className: "space-y-6 max-w-lg", children: [_jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium", children: "Authentication Type" }), _jsxs("select", { value: activeRequest.auth.type, onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, type: e.target.value } }), className: "flex h-10 w-full rounded-md px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input appearance-none", children: [_jsx("option", { value: "none", className: "bg-popover text-popover-foreground", children: "No Authentication" }), _jsx("option", { value: "bearer", className: "bg-popover text-popover-foreground", children: "Bearer Token" }), _jsx("option", { value: "basic", className: "bg-popover text-popover-foreground", children: "Basic Auth" }), _jsx("option", { value: "api-key", className: "bg-popover text-popover-foreground", children: "API Key" })] })] }), activeRequest.auth.type === 'bearer' && (_jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium", children: "Token" }), _jsx("input", { type: "text", placeholder: "e.g. eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...", value: activeRequest.auth.token || '', onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, token: e.target.value } }), className: "flex h-10 w-full rounded-md px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" })] })), activeRequest.auth.type === 'basic' && (_jsxs("div", { className: "grid grid-cols-2 gap-4", children: [_jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium", children: "Username" }), _jsx("input", { type: "text", value: activeRequest.auth.username || '', onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, username: e.target.value } }), className: "flex h-10 w-full rounded-md px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" })] }), _jsxs("div", { className: "space-y-2", children: [_jsx("label", { className: "text-sm font-medium", children: "Password" }), _jsx("input", { type: "password", value: activeRequest.auth.password || '', onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, password: e.target.value } }), className: "flex h-10 w-full rounded-md px-3 py-2 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 glass-input" })] })] }))] })), activeTab === 'body' && (_jsxs("div", { className: "h-full flex flex-col gap-4", children: [_jsxs("div", { className: "flex items-center gap-4 text-sm", children: [_jsxs("label", { className: "flex items-center gap-2 cursor-pointer", children: [_jsx("input", { type: "radio", className: "text-primary focus:ring-primary/20 bg-glass-highlight border-glass-border", checked: activeRequest.body.type === 'none', onChange: () => updateRequest({ body: { type: 'none', content: '' } }) }), _jsx("span", { className: "ml-2", children: "None" })] }), _jsxs("label", { className: "flex items-center gap-2 cursor-pointer", children: [_jsx("input", { type: "radio", className: "text-primary focus:ring-primary/20 bg-glass-highlight border-glass-border", checked: activeRequest.body.type === 'json', onChange: () => updateRequest({ body: { type: 'json', content: activeRequest.body.content || '' } }) }), _jsx("span", { className: "ml-2", children: "JSON" })] })] }), activeRequest.body.type === 'json' && (_jsx("div", { className: "flex-1 border border-glass-border rounded-md overflow-hidden shadow-inner bg-black/20", children: _jsx(CodeEditor, { value: activeRequest.body.content, onChange: (value) => updateRequest({ body: { ...activeRequest.body, content: value } }), language: "json", className: "h-full bg-transparent" }) })), activeRequest.body.type === 'none' && (_jsx("div", { className: "flex-1 flex items-center justify-center text-muted-foreground text-sm border-2 border-dashed border-glass-border rounded-lg bg-glass-highlight/5", children: "This request has no body" }))] }))] })] }));
}
//# sourceMappingURL=RequestPanel.js.map