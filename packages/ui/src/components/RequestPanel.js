import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { Plus, Trash2, Send } from 'lucide-react';
import { useRequestStore } from '@vessel/core';
import { CodeEditor } from './CodeEditor';
import { Button } from './Button';
import { Input } from './Input';
import { Select } from './Select';
import { Checkbox } from './Checkbox';
import { Label } from './Label';
import { Tabs, TabsList, TabsTrigger, TabsContent } from './Tabs';
import { ScrollArea } from './ScrollArea';
import { cn, getMethodColor } from '../lib/utils';
export function RequestPanel() {
    const { activeRequest, updateRequest, executeRequest, isLoading } = useRequestStore();
    const [activeTab, setActiveTab] = useState('params');
    if (!activeRequest) {
        return (_jsx("div", { className: "flex h-full items-center justify-center text-muted-foreground p-4", children: "Select or create a request to get started" }));
    }
    const handleSend = () => {
        executeRequest();
    };
    const addKeyValuePair = (type) => {
        updateRequest({
            [type]: [...activeRequest[type], { id: crypto.randomUUID(), key: '', value: '', enabled: true }]
        });
    };
    const updateKeyValuePair = (type, index, updates) => {
        const newItems = [...activeRequest[type]];
        newItems[index] = { ...newItems[index], ...updates };
        updateRequest({ [type]: newItems });
    };
    const removeKeyValuePair = (type, index) => {
        const newItems = activeRequest[type].filter((_, i) => i !== index);
        updateRequest({ [type]: newItems });
    };
    return (_jsxs("div", { className: "h-full flex flex-col bg-background", children: [_jsxs("div", { className: "h-14 shrink-0 flex items-center gap-2 px-4 border-b border-border bg-card", children: [_jsx("div", { className: "w-32", children: _jsx(Select, { value: activeRequest.method, onChange: (e) => updateRequest({ method: e.target.value }), className: cn("font-bold h-9", getMethodColor(activeRequest.method)), children: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS'].map((m) => (_jsx("option", { value: m, className: "bg-popover text-popover-foreground", children: m }, m))) }) }), _jsx("div", { className: "flex-1", children: _jsx(Input, { type: "text", value: activeRequest.url, onChange: (e) => updateRequest({ url: e.target.value }), placeholder: "https://api.example.com/v1/resource", className: "h-9" }) }), _jsx(Button, { onClick: handleSend, disabled: isLoading || !activeRequest.url, className: "h-9 px-6 font-semibold shadow-none border border-primary/20 hover:border-primary/50", children: isLoading ? (_jsxs(_Fragment, { children: [_jsx("span", { className: "mr-2 h-4 w-4 animate-spin rounded-full border-2 border-background border-r-transparent" }), _jsx("span", { children: "Sending..." })] })) : (_jsxs(_Fragment, { children: [_jsx(Send, { className: "mr-2 h-4 w-4" }), "Send"] })) })] }), _jsxs(Tabs, { value: activeTab, onValueChange: (v) => setActiveTab(v), className: "flex-1 min-h-0 flex flex-col", children: [_jsx("div", { className: "shrink-0 border-b border-border px-4 bg-muted/20", children: _jsxs(TabsList, { children: [_jsx(TabsTrigger, { value: "params", children: "Params" }), _jsx(TabsTrigger, { value: "headers", children: "Headers" }), _jsx(TabsTrigger, { value: "auth", children: "Auth" }), _jsx(TabsTrigger, { value: "body", children: "Body" })] }) }), _jsxs("div", { className: "flex-1 min-h-0", children: [_jsx(TabsContent, { value: "params", className: "h-full", children: _jsx(ScrollArea, { className: "h-full w-full", children: _jsxs("div", { className: "p-4 space-y-4", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("h3", { className: "text-sm font-medium text-muted-foreground", children: "Query Parameters" }), _jsxs(Button, { variant: "ghost", size: "sm", onClick: () => addKeyValuePair('queryParams'), className: "h-8", children: [_jsx(Plus, { className: "h-4 w-4 mr-1" }), " Add Param"] })] }), activeRequest.queryParams.map((param, index) => (_jsxs("div", { className: "flex gap-2 items-center group", children: [_jsx(Checkbox, { checked: param.enabled, onCheckedChange: (checked) => updateKeyValuePair('queryParams', index, { enabled: !!checked }) }), _jsx(Input, { placeholder: "Key", value: param.key, onChange: (e) => updateKeyValuePair('queryParams', index, { key: e.target.value }) }), _jsx(Input, { placeholder: "Value", value: param.value, onChange: (e) => updateKeyValuePair('queryParams', index, { value: e.target.value }) }), _jsx(Button, { variant: "ghost", size: "icon", className: "h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive hover:bg-destructive/10", onClick: () => removeKeyValuePair('queryParams', index), children: _jsx(Trash2, { className: "h-4 w-4" }) })] }, param.id))), activeRequest.queryParams.length === 0 && (_jsx("div", { className: "text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-border rounded-lg", children: "No query parameters used" }))] }) }) }), _jsx(TabsContent, { value: "headers", className: "h-full", children: _jsx(ScrollArea, { className: "h-full w-full", children: _jsxs("div", { className: "p-4 space-y-4", children: [_jsxs("div", { className: "flex items-center justify-between", children: [_jsx("h3", { className: "text-sm font-medium text-muted-foreground", children: "HTTP Headers" }), _jsxs(Button, { variant: "ghost", size: "sm", onClick: () => addKeyValuePair('headers'), className: "h-8", children: [_jsx(Plus, { className: "h-4 w-4 mr-1" }), " Add Header"] })] }), activeRequest.headers.map((header, index) => (_jsxs("div", { className: "flex gap-2 items-center group", children: [_jsx(Checkbox, { checked: header.enabled, onCheckedChange: (checked) => updateKeyValuePair('headers', index, { enabled: !!checked }) }), _jsx(Input, { placeholder: "Key", value: header.key, onChange: (e) => updateKeyValuePair('headers', index, { key: e.target.value }) }), _jsx(Input, { placeholder: "Value", value: header.value, onChange: (e) => updateKeyValuePair('headers', index, { value: e.target.value }) }), _jsx(Button, { variant: "ghost", size: "icon", className: "h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive hover:bg-destructive/10", onClick: () => removeKeyValuePair('headers', index), children: _jsx(Trash2, { className: "h-4 w-4" }) })] }, header.id))), activeRequest.headers.length === 0 && (_jsx("div", { className: "text-center py-8 text-muted-foreground text-sm border-2 border-dashed border-border rounded-lg", children: "No custom headers" }))] }) }) }), _jsx(TabsContent, { value: "auth", className: "h-full", children: _jsx(ScrollArea, { className: "h-full w-full", children: _jsxs("div", { className: "p-4 space-y-6 max-w-lg", children: [_jsxs("div", { className: "space-y-2", children: [_jsx(Label, { htmlFor: "auth-type", children: "Authentication Type" }), _jsxs(Select, { id: "auth-type", value: activeRequest.auth.type, onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, type: e.target.value } }), children: [_jsx("option", { value: "none", className: "bg-popover text-popover-foreground", children: "No Authentication" }), _jsx("option", { value: "bearer", className: "bg-popover text-popover-foreground", children: "Bearer Token" }), _jsx("option", { value: "basic", className: "bg-popover text-popover-foreground", children: "Basic Auth" }), _jsx("option", { value: "api-key", className: "bg-popover text-popover-foreground", children: "API Key" })] })] }), activeRequest.auth.type === 'bearer' && (_jsxs("div", { className: "space-y-2", children: [_jsx(Label, { htmlFor: "auth-token", children: "Token" }), _jsx(Input, { id: "auth-token", type: "text", placeholder: "e.g. eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...", value: activeRequest.auth.token || '', onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, token: e.target.value } }) })] })), activeRequest.auth.type === 'basic' && (_jsxs("div", { className: "grid grid-cols-2 gap-4", children: [_jsxs("div", { className: "space-y-2", children: [_jsx(Label, { htmlFor: "auth-username", children: "Username" }), _jsx(Input, { id: "auth-username", type: "text", value: activeRequest.auth.username || '', onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, username: e.target.value } }) })] }), _jsxs("div", { className: "space-y-2", children: [_jsx(Label, { htmlFor: "auth-password", children: "Password" }), _jsx(Input, { id: "auth-password", type: "password", value: activeRequest.auth.password || '', onChange: (e) => updateRequest({ auth: { ...activeRequest.auth, password: e.target.value } }) })] })] }))] }) }) }), _jsxs(TabsContent, { value: "body", className: "h-full flex flex-col", children: [_jsxs("div", { className: "shrink-0 flex items-center gap-4 px-4 py-[11px] text-sm border-b border-border", children: [_jsxs("div", { className: "flex items-center gap-2", children: [_jsx("input", { id: "body-none", type: "radio", className: "text-primary focus:ring-primary/20 bg-muted border-border", checked: activeRequest.body.type === 'none', onChange: () => updateRequest({ body: { type: 'none', content: '' } }) }), _jsx(Label, { htmlFor: "body-none", className: "cursor-pointer", children: "None" })] }), _jsxs("div", { className: "flex items-center gap-2", children: [_jsx("input", { id: "body-json", type: "radio", className: "text-primary focus:ring-primary/20 bg-muted border-border", checked: activeRequest.body.type === 'json', onChange: () => updateRequest({ body: { type: 'json', content: activeRequest.body.content || '' } }) }), _jsx(Label, { htmlFor: "body-json", className: "cursor-pointer", children: "JSON" })] })] }), _jsx("div", { className: "flex-1 min-h-0 p-4", children: activeRequest.body.type === 'json' ? (_jsx(CodeEditor, { value: activeRequest.body.content, onChange: (value) => updateRequest({ body: { ...activeRequest.body, content: value } }), language: "json", className: "h-full" })) : (_jsx("div", { className: "h-full flex items-center justify-center text-muted-foreground text-sm border-2 border-dashed border-border rounded-lg bg-muted/5", children: "This request has no body" })) })] })] })] })] }));
}
//# sourceMappingURL=RequestPanel.js.map